http:
 middlewares:
{% if (traefik_basic_auth_users | default([])) | length > 0 %}
 auth-dashboard:
 basicAuth:
 users:
{% for line in traefik_basic_auth_users %}
 - {{ line | to_json }}
{% endfor %}
{% endif %}

{% if (traefik_dashboard_allowlist | default([])) | length > 0 %}
 ip-allow:
 ipWhiteList:
 sourceRange:
{% for cidr in traefik_dashboard_allowlist %}
 - "{{ cidr }}"
{% endfor %}
{% endif %}

 secure-headers:
 headers:
 frameDeny: true
 contentTypeNosniff: true
 browserXssFilter: true
 referrerPolicy: "no-referrer"
 stsSeconds: 31536000
 stsIncludeSubdomains: true
 stsPreload: true

 rate-limit:
 rateLimit:
 average: 50
 burst: 100

 chain-secure:
 chain:
 middlewares:
 - "secure-headers"
 - "rate-limit"
{% if (traefik_basic_auth_users | default([])) | length > 0 %}
 - "auth-dashboard"
{% endif %}
{% if (traefik_dashboard_allowlist | default([])) | length > 0 %}
 - "ip-allow"
{% endif %}

